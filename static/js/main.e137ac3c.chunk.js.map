{"version":3,"sources":["img/roll.svg","components/Sliders.js","panels/Home.js","panels/Intro.js","App.js","index.js"],"names":["SHEETS_PER_ROLL","IS_TAPTIC_SUPPORTED","bridge","supports","throttle","callback","delay","args","context","isThrottled","wrapper","arguments","this","apply","setTimeout","Home","fetchedState","snackbarError","useState","hasOwnProperty","rollsCount","setRollsCount","toiletVisits","setToiletVisits","personsCount","setPersonsCount","sheetsCount","setSheetsCount","snackbar","setSnackbar","onSheet","a","send","type","Snackbar","layout","onClose","before","Avatar","size","style","backgroundColor","fill","width","height","duration","newSheetsCount","newRollsCount","Math","floor","setStorage","properties","key","value","JSON","stringify","onRollsChange","rolls","onVisitsChange","visits","onPersonsChange","persons","Group","className","sheetsPerDay","totalSheets","round","countDays","FormLayout","Slider","step","min","max","top","Header","indicator","Counter","mode","role","aria-label","onChange","FixedLayout","vertical","Div","Button","onClick","src","roll","alt","id","Panel","PanelHeader","Sliders","Intro","go","route","fetchedUser","userHasSeenIntro","centered","photo_200","first_name","level","ROUTES","STORAGE_KEYS","App","activePanel","setActivePanel","setUser","setFetchedState","ScreenSpinner","popout","setPopout","setUserHasSeenIntro","useEffect","user","keys","sheetState","Array","isArray","data","forEach","parse","hasSeenIntro","error","subscribe","detail","schemeAttribute","document","createAttribute","scheme","body","attributes","setNamedItem","fetchData","panel","viewIntro","View","ReactDOM","render","getElementById"],"mappings":"qrBAAe,MAA0B,iC,OCenCA,EAAoB,IAKpBC,EAAsBC,IAAOC,SAAS,sCAE5C,SAASC,EAASC,EAAUC,GAC3B,IAAyBC,EAAMC,EAA3BC,GAAc,EAoBlB,OAlBA,SAASC,IACR,GAAID,EAGH,OAFAF,EAAOI,eACPH,EAAUI,MAIXH,GAAc,EACdJ,EAASQ,MAAMD,KAAMD,WAErBG,YAAW,WACVL,GAAc,EACVF,IACHG,EAAQG,MAAML,EAASD,GACvBA,EAAOC,EAAU,QAEhBF,IAKL,IA2IeS,EA3IF,SAAC,GAAqC,IAAnCC,EAAkC,EAAlCA,aAAcC,EAAoB,EAApBA,cAAoB,EACbC,mBAASF,EAAaG,eAAe,cAAgBH,EAAaI,WA9B1E,GA6BqB,mBAC1CA,EAD0C,KAC9BC,EAD8B,OAETH,mBAASF,EAAaG,eAAe,gBAAkBH,EAAaM,aA9B/E,GA4BoB,mBAE1CA,EAF0C,KAE5BC,EAF4B,OAGTL,mBAASF,EAAaG,eAAe,gBAAkBH,EAAaQ,aA9B/E,GA2BoB,mBAG1CA,EAH0C,KAG5BC,EAH4B,OAIXP,mBAASF,EAAaG,eAAe,eAAiBH,EAAaU,YAAc1B,KAJtE,mBAI1C0B,EAJ0C,KAI7BC,EAJ6B,OAKjBT,mBAASD,GALQ,mBAK1CW,EAL0C,KAKhCC,EALgC,KAO3CC,EAAO,uCAAG,8BAAAC,EAAA,0DACX9B,EADW,gCAERC,IAAO8B,KAAK,qCAAsC,CAAEC,KAAMP,GAAe,EAAI,QAAU,YAF/E,YAIXA,GAAe,GAJJ,uBAKdG,EAAY,cAACK,EAAA,EAAD,CACXC,OAAO,WACPC,QAAS,kBAAMP,EAAY,OAC3BQ,OAAQ,cAACC,EAAA,EAAD,CAAQC,KAAM,GAAIC,MAAO,CAACC,gBAAiB,iBAA3C,SAA6D,cAAC,IAAD,CAAuBC,KAAK,OAAOC,MAAO,GAAIC,OAAQ,OAC3HC,SAAU,IAJC,uJAQZxB,EAAc,GAbA,0BAgBTyB,EAAiBpB,EAAc,EAC/BqB,EAAgBC,KAAKC,MAAMH,EAAiB9C,GAElD2B,EAAemB,GACX1B,IAAe2B,GAAmC,IAAlBA,GACnC1B,EAAc0B,GAEflB,EAAY,cAACK,EAAA,EAAD,CACXC,OAAO,WACPC,QAAS,kBAAMP,EAAY,OAC3BQ,OAAQ,cAACC,EAAA,EAAD,CAAQC,KAAM,GAAIC,MAAO,CAACC,gBAAiB,iBAA3C,SAA6D,cAAC,IAAD,CAAuBC,KAAK,OAAOC,MAAO,GAAIC,OAAQ,OAC3HC,SAAU,IAJC,SAMVC,GAAkB,EAAI,2IAAtB,+MAA6FA,MAE/FI,EAAW,CACVxB,YAAaoB,IAhCC,4CAAH,qDAoCPI,EAAU,uCAAG,WAAeC,GAAf,SAAApB,EAAA,sEACZ7B,IAAO8B,KAAK,qBAAsB,CACvCoB,IAAK,QACLC,MAAOC,KAAKC,UAAL,aACNnC,aACAE,eACAE,eACAE,eACGyB,MARa,2CAAH,sDAmBVK,EAAgBpD,GAAS,SAAAqD,GAC1BA,IAAUrC,IACdO,EAAeD,GAAe+B,EAAQrC,GAAcpB,GACpDqB,EAAcoC,GACdP,OACE,KAEGQ,EAAiBtD,GAAS,SAAAuD,GAC3BA,IAAWrC,IACfC,EAAgBoC,GAChBT,OACE,KAEGU,EAAkBxD,GAAS,SAAAyD,GAC5BA,IAAYrC,IAChBC,EAAgBoC,GAChBX,OACE,KAEH,OACC,eAAC,WAAD,WACC,eAACY,EAAA,EAAD,WACC,oBAAIC,UAAU,kBAAd,SA5Be,WACjB,IAAMC,EAvFmB,EAuFe1C,EAAeE,EACjDyC,EAAc7C,EAAapB,EACjC,OAAOgD,KAAKkB,MAAMD,EAAcD,GAyBGG,KACjC,oBAAIJ,UAAU,qBAAd,0KAED,eAACK,EAAA,EAAD,WACE,cAACC,EAAA,EAAD,CACCC,KAAM,EACNC,IAAK,EACLC,IAAK,GACLnB,MAAOjC,EACPqD,IACC,eAACC,EAAA,EAAD,CAAQC,UAAW,cAACC,EAAA,EAAD,CAASrC,KAAK,IAAIsC,KAAK,UAAvB,SAAkCzD,IAArD,UACC,sBAAM0D,KAAK,MAAMC,aAAW,eAA5B,0BADD,8GAIDC,SAAU,SAACvB,GAAD,OAAWD,EAAcC,MAEpC,cAACY,EAAA,EAAD,CACCC,KAAM,EACNC,IAAK,EACLC,IAAK,EACLnB,MAAO/B,EACPmD,IACC,eAACC,EAAA,EAAD,CAAQC,UAAW,cAACC,EAAA,EAAD,CAASrC,KAAK,IAAIsC,KAAK,UAAvB,SAAkCvD,IAArD,UACC,sBAAMwD,KAAK,MAAMC,aAAW,MAA5B,0BADD,wIAIDC,SAAU,SAAArB,GAAM,OAAID,EAAeC,MAEpC,cAACU,EAAA,EAAD,CACCC,KAAM,EACNC,IAAK,EACLC,IAAK,GACLnB,MAAO7B,EACPiD,IACC,eAACC,EAAA,EAAD,CAAQC,UAAW,cAACC,EAAA,EAAD,CAASrC,KAAK,IAAIsC,KAAK,UAAvB,SAAkCrD,IAArD,UACC,sBAAMsD,KAAK,MAAMC,aAAW,sBAA5B,gFADD,8DAIDC,SAAU,SAAAnB,GAAO,OAAID,EAAgBC,SAIxC,cAACoB,EAAA,EAAD,CAAaC,SAAS,SAAtB,SACC,cAACC,EAAA,EAAD,CAAKpB,UAAU,kBAAf,SACC,cAACqB,EAAA,EAAD,CAASrB,UAAU,SAASxB,KAAK,KAAK8C,QAASvD,EAA/C,SACC,qBAAKwD,IAAKC,EAAMC,IAAI,4BAKtB5D,MCnKWb,G,OAVF,SAAC,GAAyC,IAAvC0E,EAAsC,EAAtCA,GAAIxE,EAAkC,EAAlCA,cAAeD,EAAmB,EAAnBA,aAElC,OACC,eAAC0E,EAAA,EAAD,CAAOD,GAAIA,EAAX,UACC,cAACE,EAAA,EAAD,qJACC3E,GAAgB,cAAC4E,EAAD,CAAS5E,aAAcA,EAAcC,cAAeA,SCsBzD4E,G,OAvBD,SAAC,GAAD,IAAGJ,EAAH,EAAGA,GAAIK,EAAP,EAAOA,GAAIC,EAAX,EAAWA,MAAOC,EAAlB,EAAkBA,YAAaC,EAA/B,EAA+BA,iBAA/B,OACb,eAACP,EAAA,EAAD,CAAOD,GAAIA,EAAIS,UAAU,EAAzB,UACC,cAACP,EAAA,EAAD,2EACEK,IAAgBC,GACjB,eAAC,WAAD,WACC,cAACnC,EAAA,EAAD,UACC,eAACqB,EAAA,EAAD,CAAKpB,UAAU,OAAf,UACEiC,EAAYG,UAAY,cAAC7D,EAAA,EAAD,CAAQgD,IAAKU,EAAYG,YAAe,KACjE,+BAAKH,EAAYI,WAAjB,wZAIF,cAACnB,EAAA,EAAD,CAAaC,SAAS,SAAtB,SACC,cAACC,EAAA,EAAD,UACC,cAACC,EAAA,EAAD,CAAQP,KAAK,WAAWtC,KAAK,MAAM8D,MAAM,IAAIhB,QAAS,kBAAMS,EAAGC,IAA/D,8DCZAO,EACC,OADDA,EAEE,QAGFC,EACE,QADFA,EAEG,aAiGMC,EA9FH,WAAO,IAAD,EACqBtF,mBAASoF,GAD9B,mBACVG,EADU,KACGC,EADH,OAEcxF,mBAAS,MAFvB,mBAEV8E,EAFU,KAEGW,EAFH,OAGuBzF,mBAAS,MAHhC,mBAGVF,EAHU,KAGI4F,EAHJ,OAIe1F,mBAAS,MAJxB,mBAIVU,EAJU,KAIAC,EAJA,OAKWX,mBAAS,cAAC2F,EAAA,EAAD,CAAetE,KAAK,WALxC,mBAKVuE,EALU,KAKFC,EALE,OAM+B7F,oBAAS,GANxC,mBAMV+E,EANU,KAMQe,EANR,KAQjBC,qBAAU,WAAM,4CAQf,gCAAAlF,EAAA,sEACoB7B,IAAO8B,KAAK,uBADhC,cACOkF,EADP,gBAE0BhH,IAAO8B,KAAK,qBAAsB,CAAEmF,KAAM,CAACZ,EAAoBA,KAFzF,OAEOa,EAFP,OAGKC,MAAMC,QAAQF,EAAWD,OACtBI,EAAO,GACbH,EAAWD,KAAKK,SAAQ,YAAqB,IAAlBpE,EAAiB,EAAjBA,IAAKC,EAAY,EAAZA,MAC/B,IAEC,OADAkE,EAAKnE,GAAOC,EAAQC,KAAKmE,MAAMpE,GAAS,GAChCD,GACP,KAAKmD,EACJK,EAAgBW,EAAKhB,IACrB,MACD,KAAKA,EACAgB,EAAKnE,IAAQmE,EAAKnE,GAAKsE,eAC1BhB,EAAeJ,GACfU,GAAoB,KAMtB,MAAOW,GACR9F,EAAY,cAACK,EAAA,EAAD,CACXC,OAAO,WACPC,QAAS,kBAAMP,EAAY,OAC3BQ,OAAQ,cAACC,EAAA,EAAD,CAAQC,KAAM,GAAIC,MAAO,CAACC,gBAAiB,sBAA3C,SAAkE,cAAC,IAAD,CAAaC,KAAK,OAAOC,MAAO,GAAIC,OAAQ,OACtHC,SAAU,IAJC,6LASZ+D,EAAgB,SAKlBA,EAAgB,IAEjBD,EAAQO,GACRH,EAAU,MAvCX,4CARe,sBACf7G,IAAO0H,WAAU,YAAgC,IAAD,IAA5BC,OAAU5F,EAAkB,EAAlBA,KAAMsF,EAAY,EAAZA,KACnC,GAAa,yBAATtF,EAAiC,CACpC,IAAM6F,EAAkBC,SAASC,gBAAgB,UACjDF,EAAgBzE,MAAQkE,EAAKU,OAASV,EAAKU,OAAS,eACpDF,SAASG,KAAKC,WAAWC,aAAaN,OALzB,mCAiDfO,KACE,IAEH,IAAMvC,EAAK,SAAAwC,GACV5B,EAAe4B,IAGVC,EAAS,uCAAG,WAAOD,GAAP,SAAAvG,EAAA,+EAEV7B,IAAO8B,KAAK,qBAAsB,CACvCoB,IAAKmD,EACLlD,MAAOC,KAAKC,UAAU,CACrBmE,cAAc,MALA,OAQhB5B,EAAGwC,GARa,+CAUhBzG,EAAY,cAACK,EAAA,EAAD,CACXC,OAAO,WACPC,QAAS,kBAAMP,EAAY,OAC3BQ,OAAQ,cAACC,EAAA,EAAD,CAAQC,KAAM,GAAIC,MAAO,CAACC,gBAAiB,sBAA3C,SAAkE,cAAC,IAAD,CAAaC,KAAK,OAAOC,MAAO,GAAIC,OAAQ,OACtHC,SAAU,IAJC,iLAVI,wDAAH,sDAsBf,OACC,eAAC2F,EAAA,EAAD,CAAM/B,YAAaA,EAAaK,OAAQA,EAAxC,UACC,cAAC,EAAD,CAAMrB,GAAIa,EAAatF,aAAcA,EAAcC,cAAeW,IAClE,cAAC,EAAD,CAAO6D,GAAIa,EAAcN,YAAaA,EAAaF,GAAIyC,EAAWxC,MAAOO,EAAaL,iBAAkBA,QCxG3G/F,IAAO8B,KAAK,gBAEZyG,IAASC,OAAO,cAAC,EAAD,IAASX,SAASY,eAAe,W","file":"static/js/main.e137ac3c.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/roll.dc28fc8f.svg\";","import React, { useState, Fragment } from 'react';\nimport Slider from '@vkontakte/vkui/dist/components/Slider/Slider';\nimport Header from '@vkontakte/vkui/dist/components/Header/Header';\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport FixedLayout from '@vkontakte/vkui/dist/components/FixedLayout/FixedLayout';\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport FormLayout from '@vkontakte/vkui/dist/components/FormLayout/FormLayout';\nimport Counter from '@vkontakte/vkui/dist/components/Counter/Counter';\nimport Snackbar from '@vkontakte/vkui/dist/components/Snackbar/Snackbar';\nimport Icon28DocumentOutline from '@vkontakte/icons/dist/28/document_outline';\nimport bridge from '@vkontakte/vk-bridge';\nimport roll from '../img/roll.svg';\n\nconst SHEETS_PER_ROLL \t\t= 160;\nconst SHEETS_PER_VISIT \t\t= 7;\nconst DEFAULT_ROLLS_COUNT \t= 4;\nconst DEFAULT_TOILET_VISITS = 3;\nconst DEFAULT_PERSONS_COUNT = 2;\nconst IS_TAPTIC_SUPPORTED\t= bridge.supports('VKWebAppTapticNotificationOccurred');\n\nfunction throttle(callback, delay) {\n\tlet isThrottled = false, args, context;\n\n\tfunction wrapper() {\n\t\tif (isThrottled) {\n\t\t\targs = arguments;\n\t\t\tcontext = this;\n\t\t\treturn;\n\t\t}\n\n\t\tisThrottled = true;\n\t\tcallback.apply(this, arguments);\n\t\t\n\t\tsetTimeout(() => {\n\t\t\tisThrottled = false;\n\t\t\tif (args) {\n\t\t\t\twrapper.apply(context, args);\n\t\t\t\targs = context = null;\n\t\t\t}\n\t\t}, delay);\n\t}\n\treturn wrapper;\n}\n\nconst Home = ({ fetchedState, snackbarError }) => {\n\tconst [rollsCount, setRollsCount] = useState(fetchedState.hasOwnProperty('rollsCount') ? fetchedState.rollsCount : DEFAULT_ROLLS_COUNT);\n\tconst [toiletVisits, setToiletVisits] = useState(fetchedState.hasOwnProperty('toiletVisits') ? fetchedState.toiletVisits : DEFAULT_TOILET_VISITS);\n\tconst [personsCount, setPersonsCount] = useState(fetchedState.hasOwnProperty('personsCount') ? fetchedState.personsCount : DEFAULT_PERSONS_COUNT);\n\tconst [sheetsCount, setSheetsCount] = useState(fetchedState.hasOwnProperty('sheetsCount') ? fetchedState.sheetsCount : SHEETS_PER_ROLL * DEFAULT_ROLLS_COUNT);\n\tconst [snackbar, setSnackbar] = useState(snackbarError);\n\n\tconst onSheet = async function () {\n\t\tif (IS_TAPTIC_SUPPORTED) {\n\t\t\tawait bridge.send('VKWebAppTapticNotificationOccurred', { type: sheetsCount <= 0 ? 'error' : 'success' });\n\t\t}\n\t\tif (sheetsCount <= 0) {\n\t\t\tsetSnackbar(<Snackbar\n\t\t\t\tlayout='vertical'\n\t\t\t\tonClose={() => setSnackbar(null)}\n\t\t\t\tbefore={<Avatar size={24} style={{backgroundColor: 'var(--accent)'}}><Icon28DocumentOutline fill='#fff' width={14} height={14} /></Avatar>}\n\t\t\t\tduration={900}\n\t\t\t>\n\t\t\t\tУ вас не осталось туалетки\n\t\t\t</Snackbar>);\n\t\t\tsetRollsCount(0);\n\t\t\treturn;\n\t\t}\n\t\tconst newSheetsCount = sheetsCount - 1;\n\t\tconst newRollsCount = Math.floor(newSheetsCount / SHEETS_PER_ROLL);\n\n\t\tsetSheetsCount(newSheetsCount);\n\t\tif (rollsCount !== newRollsCount && newRollsCount !== 0) {\n\t\t\tsetRollsCount(newRollsCount);\n\t\t}\n\t\tsetSnackbar(<Snackbar\n\t\t\tlayout='vertical'\n\t\t\tonClose={() => setSnackbar(null)}\n\t\t\tbefore={<Avatar size={24} style={{backgroundColor: 'var(--accent)'}}><Icon28DocumentOutline fill='#fff' width={14} height={14} /></Avatar>}\n\t\t\tduration={900}\n\t\t>\n\t\t\t{newSheetsCount <= 0 ? 'У вас не осталось туалетки' : `Листочек туалетки потрачен, осталось ${newSheetsCount}`}\n\t\t</Snackbar>);\n\t\tsetStorage({\n\t\t\tsheetsCount: newSheetsCount\n\t\t});\n\t}\n\n\tconst setStorage = async function(properties) {\n\t\tawait bridge.send('VKWebAppStorageSet', {\n\t\t\tkey: 'state',\n\t\t\tvalue: JSON.stringify({\n\t\t\t\trollsCount,\n\t\t\t\ttoiletVisits,\n\t\t\t\tpersonsCount,\n\t\t\t\tsheetsCount,\n\t\t\t\t...properties\n\t\t\t})\n\t\t});\n\t}\n\n\tconst countDays = function() {\n\t\tconst sheetsPerDay = SHEETS_PER_VISIT * toiletVisits * personsCount;\n\t\tconst totalSheets = rollsCount * SHEETS_PER_ROLL\n\t\treturn Math.round(totalSheets / sheetsPerDay);\n\t}\n\n\tconst onRollsChange = throttle(rolls => {\n\t\tif (rolls === rollsCount) return;\n\t\tsetSheetsCount(sheetsCount + (rolls - rollsCount) * SHEETS_PER_ROLL);\n\t\tsetRollsCount(rolls);\n\t\tsetStorage();\n\t}, 200);\n\n\tconst onVisitsChange = throttle(visits => {\n\t\tif (visits === toiletVisits) return;\n\t\tsetToiletVisits(visits)\n\t\tsetStorage();\n\t}, 200);\n\n\tconst onPersonsChange = throttle(persons => {\n\t\tif (persons === personsCount) return;\n\t\tsetPersonsCount(persons);\n\t\tsetStorage();\n\t}, 200);\n\n\treturn (\n\t\t<Fragment>\n\t\t\t<Group>\n\t\t\t\t<h1 className='DaysLeftHeading'>{countDays()}</h1>\n\t\t\t\t<h3 className='DaysLeftSubheading'>Столько дней вы продержитесь</h3>\n\t\t\t</Group>\n\t\t\t<FormLayout>\n\t\t\t\t\t<Slider\n\t\t\t\t\t\tstep={1}\n\t\t\t\t\t\tmin={0}\n\t\t\t\t\t\tmax={48}\n\t\t\t\t\t\tvalue={rollsCount}\n\t\t\t\t\t\ttop={\n\t\t\t\t\t\t\t<Header indicator={<Counter size='m' mode='primary'>{rollsCount}</Counter>}>\n\t\t\t\t\t\t\t\t<span role='img' aria-label='Toilet paper'>🧻</span> Количество рулонов\n\t\t\t\t\t\t\t</Header>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonChange={(rolls) => onRollsChange(rolls)}\n\t\t\t\t\t/>\n\t\t\t\t\t<Slider\n\t\t\t\t\t\tstep={1}\n\t\t\t\t\t\tmin={1}\n\t\t\t\t\t\tmax={8}\n\t\t\t\t\t\tvalue={toiletVisits}\n\t\t\t\t\t\ttop={\n\t\t\t\t\t\t\t<Header indicator={<Counter size='m' mode='primary'>{toiletVisits}</Counter>}>\n\t\t\t\t\t\t\t\t<span role='img' aria-label='Poo'>💩</span> Посещений туалета в день\n\t\t\t\t\t\t\t</Header>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonChange={visits => onVisitsChange(visits)}\n\t\t\t\t\t/>\n\t\t\t\t\t<Slider\n\t\t\t\t\t\tstep={1}\n\t\t\t\t\t\tmin={1}\n\t\t\t\t\t\tmax={16}\n\t\t\t\t\t\tvalue={personsCount}\n\t\t\t\t\t\ttop={\n\t\t\t\t\t\t\t<Header indicator={<Counter size='m' mode='primary'>{personsCount}</Counter>}>\n\t\t\t\t\t\t\t\t<span role='img' aria-label='People in household'>👨‍👩‍👧‍👦</span> Людей дома\n\t\t\t\t\t\t\t</Header>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonChange={persons => onPersonsChange(persons)}\n\t\t\t\t\t/>\n\t\t\t</FormLayout>\n\n\t\t\t<FixedLayout vertical=\"bottom\">\n\t\t\t\t<Div className='PooBtnContainer'>\n\t\t\t\t\t<Button  className='PooBtn' size='xl' onClick={onSheet}>\n\t\t\t\t\t\t<img src={roll} alt=\"Toilet paper roll\"/>\n\t\t\t\t\t</Button>\n\t\t\t\t</Div>\n\t\t\t</FixedLayout>\n\n\t\t\t{snackbar}\n\t\t</Fragment>\n\t);\n};\n\nexport default Home;\n","import React from 'react';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Sliders from '../components/Sliders';\n\nimport './Home.css';\n\nconst Home = ({ id, snackbarError, fetchedState }) => {\n\n\treturn (\n\t\t<Panel id={id}>\n\t\t\t<PanelHeader>Информация об разработке</PanelHeader>\n\t\t\t{fetchedState && <Sliders fetchedState={fetchedState} snackbarError={snackbarError} />}\n\t\t</Panel>\n\t);\n};\n\nexport default Home;\n","import React, { Fragment } from 'react';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\nimport FixedLayout from '@vkontakte/vkui/dist/components/FixedLayout/FixedLayout';\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\n\nimport './Intro.css';\n\nconst Intro = ({ id, go, route, fetchedUser, userHasSeenIntro }) => (\n\t<Panel id={id} centered={true}>\n\t\t<PanelHeader>Разработка</PanelHeader>\n\t\t{(fetchedUser && !userHasSeenIntro) &&\n\t\t\t<Fragment>\n\t\t\t\t<Group>\n\t\t\t\t\t<Div className='User'>\n\t\t\t\t\t\t{fetchedUser.photo_200 ? <Avatar src={fetchedUser.photo_200}/> : null}\n\t\t\t\t\t\t<h3>{fetchedUser.first_name}, игра находит на стадии разработки!    Всю информацию можно найти у нас в группе!</h3>\n\n\t\t\t\t\t</Div>\n\t\t\t\t</Group>\n\t\t\t\t<FixedLayout vertical='bottom'>\n\t\t\t\t\t<Div>\n\t\t\t\t\t\t<Button mode='commerce' size=\"x50\" level=\"2\" onClick={() => go(route)}>\n\t\t\t\t\t\t\tПринял\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</Div>\n\t\t\t\t</FixedLayout>\n\t\t\t</Fragment>\n\t\t}\n\t</Panel>\n);\nexport default Intro;\n","import React, { useState, useEffect } from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport View from '@vkontakte/vkui/dist/components/View/View';\nimport Snackbar from '@vkontakte/vkui/dist/components/Snackbar/Snackbar';\nimport Avatar from '@vkontakte/vkui/dist/components/Avatar/Avatar';\nimport ScreenSpinner from '@vkontakte/vkui/dist/components/ScreenSpinner/ScreenSpinner';\nimport Icon24Error from '@vkontakte/icons/dist/24/error';\n\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport Home from './panels/Home';\nimport Intro from './panels/Intro';\n\nconst ROUTES = {\n\tHOME: 'home',\n\tINTRO: 'intro',\n};\n\nconst STORAGE_KEYS = {\n\tSTATE: 'state',\n\tSTATUS: 'viewStatus',\n};\n\nconst App = () => {\n\tconst [activePanel, setActivePanel] = useState(ROUTES.INTRO);\n\tconst [fetchedUser, setUser] = useState(null);\n\tconst [fetchedState, setFetchedState] = useState(null);\n\tconst [snackbar, setSnackbar] = useState(null);\n\tconst [popout, setPopout] = useState(<ScreenSpinner size='large' />);\n\tconst [userHasSeenIntro, setUserHasSeenIntro] = useState(false);\n\n\tuseEffect(() => {\n\t\tbridge.subscribe(({ detail: { type, data }}) => {\n\t\t\tif (type === 'VKWebAppUpdateConfig') {\n\t\t\t\tconst schemeAttribute = document.createAttribute('scheme');\n\t\t\t\tschemeAttribute.value = data.scheme ? data.scheme : 'client_light';\n\t\t\t\tdocument.body.attributes.setNamedItem(schemeAttribute);\n\t\t\t}\n\t\t});\n\t\tasync function fetchData() {\n\t\t\tconst user = await bridge.send('VKWebAppGetUserInfo');\n\t\t\tconst sheetState = await bridge.send('VKWebAppStorageGet', { keys: [STORAGE_KEYS.STATE, STORAGE_KEYS.STATUS]});\n\t\t\tif (Array.isArray(sheetState.keys)) {\n\t\t\t\tconst data = {};\n\t\t\t\tsheetState.keys.forEach(({ key, value }) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdata[key] = value ? JSON.parse(value) : {};\n\t\t\t\t\t\tswitch (key) {\n\t\t\t\t\t\t\tcase STORAGE_KEYS.STATE:\n\t\t\t\t\t\t\t\tsetFetchedState(data[STORAGE_KEYS.STATE]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase STORAGE_KEYS.STATUS:\n\t\t\t\t\t\t\t\tif (data[key] && data[key].hasSeenIntro) {\n\t\t\t\t\t\t\t\t\tsetActivePanel(ROUTES.HOME);\n\t\t\t\t\t\t\t\t\tsetUserHasSeenIntro(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tsetSnackbar(<Snackbar\n\t\t\t\t\t\t\tlayout='vertical'\n\t\t\t\t\t\t\tonClose={() => setSnackbar(null)}\n\t\t\t\t\t\t\tbefore={<Avatar size={24} style={{backgroundColor: 'var(--dynamic_red)'}}><Icon24Error fill='#fff' width={14} height={14} /></Avatar>}\n\t\t\t\t\t\t\tduration={900}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tПроблема с получением данных из Storage\n\t\t\t\t\t\t</Snackbar>\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsetFetchedState({});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\tsetFetchedState({});\n\t\t\t}\n\t\t\tsetUser(user);\n\t\t\tsetPopout(null);\n\t\t}\n\t\tfetchData();\n\t}, []);\n\n\tconst go = panel => {\n\t\tsetActivePanel(panel);\n\t};\n\n\tconst viewIntro = async (panel) => {\n\t\ttry {\n\t\t\tawait bridge.send('VKWebAppStorageSet', {\n\t\t\t\tkey: STORAGE_KEYS.STATUS,\n\t\t\t\tvalue: JSON.stringify({\n\t\t\t\t\thasSeenIntro: true,\n\t\t\t\t}),\n\t\t\t});\n\t\t\tgo(panel);\n\t\t} catch (error) {\n\t\t\tsetSnackbar(<Snackbar\n\t\t\t\tlayout='vertical'\n\t\t\t\tonClose={() => setSnackbar(null)}\n\t\t\t\tbefore={<Avatar size={24} style={{backgroundColor: 'var(--dynamic_red)'}}><Icon24Error fill='#fff' width={14} height={14} /></Avatar>}\n\t\t\t\tduration={900}\n\t\t\t>\n\t\t\t\tПроблема с отправкой данных в Storage\n\t\t\t</Snackbar>\n\t\t\t);\n\t\t}\n\t}\n\n\treturn (\n\t\t<View activePanel={activePanel} popout={popout}>\n\t\t\t<Home id={ROUTES.HOME} fetchedState={fetchedState} snackbarError={snackbar} />\n\t\t\t<Intro id={ROUTES.INTRO} fetchedUser={fetchedUser} go={viewIntro} route={ROUTES.HOME} userHasSeenIntro={userHasSeenIntro} />\n\t\t</View>\n\t);\n}\n\nexport default App;\n\n","import \"core-js/features/map\";\nimport \"core-js/features/set\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport bridge from \"@vkontakte/vk-bridge\";\nimport App from \"./App\";\n\n// Init VK  Mini App\nbridge.send(\"VKWebAppInit\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nif (process.env.NODE_ENV === \"development\") {\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\n}\n"],"sourceRoot":""}