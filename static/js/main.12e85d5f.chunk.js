(this["webpackJsonpVirtual-World"]=this["webpackJsonpVirtual-World"]||[]).push([[0],{218:function(e,t,n){},219:function(e,t,n){},220:function(e,t,n){"use strict";n.r(t);n(131),n(157),n(159),n(160),n(162),n(163),n(164),n(165),n(166),n(167),n(168),n(169),n(171),n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(182),n(183),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199);var r=n(0),a=n(65),c=n.n(a),s=n(29),i=n.n(s),o=n(40),u=n.n(o),l=n(54),j=n(30),b=n(51),d=n(55),h=n(47),f=n(129),O=n(96),p=n.n(O),x=(n(208),n(72)),m=n(73),v=n(130),y=n(78),g=n(76),S=n(52),k=n(75),C=n(53),w=n(61),V=n(127),A=n(77),N=n(95),z=n.n(N),W=n.p+"static/media/roll.dc28fc8f.svg",P=n(3),I=160,K=i.a.supports("VKWebAppTapticNotificationOccurred");function E(e,t){var n,r,a=!1;return function c(){if(a)return n=arguments,void(r=this);a=!0,e.apply(this,arguments),setTimeout((function(){a=!1,n&&(c.apply(r,n),n=r=null)}),t)}}var _=function(e){var t=e.fetchedState,n=e.snackbarError,a=Object(r.useState)(t.hasOwnProperty("rollsCount")?t.rollsCount:4),c=Object(j.a)(a,2),s=c[0],o=c[1],b=Object(r.useState)(t.hasOwnProperty("toiletVisits")?t.toiletVisits:3),f=Object(j.a)(b,2),O=f[0],p=f[1],x=Object(r.useState)(t.hasOwnProperty("personsCount")?t.personsCount:2),m=Object(j.a)(x,2),N=m[0],_=m[1],J=Object(r.useState)(t.hasOwnProperty("sheetsCount")?t.sheetsCount:640),T=Object(j.a)(J,2),U=T[0],B=T[1],H=Object(r.useState)(n),D=Object(j.a)(H,2),F=D[0],G=D[1],L=function(){var e=Object(l.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!K){e.next=3;break}return e.next=3,i.a.send("VKWebAppTapticNotificationOccurred",{type:U<=0?"error":"success"});case 3:if(!(U<=0)){e.next=7;break}return G(Object(P.jsx)(d.a,{layout:"vertical",onClose:function(){return G(null)},before:Object(P.jsx)(h.a,{size:24,style:{backgroundColor:"var(--accent)"},children:Object(P.jsx)(z.a,{fill:"#fff",width:14,height:14})}),duration:900,children:"\u0423 \u0432\u0430\u0441 \u043d\u0435 \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u0442\u0443\u0430\u043b\u0435\u0442\u043a\u0438"})),o(0),e.abrupt("return");case 7:t=U-1,n=Math.floor(t/I),B(t),s!==n&&0!==n&&o(n),G(Object(P.jsx)(d.a,{layout:"vertical",onClose:function(){return G(null)},before:Object(P.jsx)(h.a,{size:24,style:{backgroundColor:"var(--accent)"},children:Object(P.jsx)(z.a,{fill:"#fff",width:14,height:14})}),duration:900,children:t<=0?"\u0423 \u0432\u0430\u0441 \u043d\u0435 \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u0442\u0443\u0430\u043b\u0435\u0442\u043a\u0438":"\u041b\u0438\u0441\u0442\u043e\u0447\u0435\u043a \u0442\u0443\u0430\u043b\u0435\u0442\u043a\u0438 \u043f\u043e\u0442\u0440\u0430\u0447\u0435\u043d, \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c ".concat(t)})),M({sheetsCount:t});case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.send("VKWebAppStorageSet",{key:"state",value:JSON.stringify(Object(v.a)({rollsCount:s,toiletVisits:O,personsCount:N,sheetsCount:U},t))});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=E((function(e){e!==s&&(B(U+(e-s)*I),o(e),M())}),200),Q=E((function(e){e!==O&&(p(e),M())}),200),R=E((function(e){e!==N&&(_(e),M())}),200);return Object(P.jsxs)(r.Fragment,{children:[Object(P.jsxs)(k.a,{children:[Object(P.jsx)("h1",{className:"DaysLeftHeading",children:function(){var e=7*O*N,t=s*I;return Math.round(t/e)}()}),Object(P.jsx)("h3",{className:"DaysLeftSubheading",children:"\u0421\u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043d\u0435\u0439 \u0432\u044b \u043f\u0440\u043e\u0434\u0435\u0440\u0436\u0438\u0442\u0435\u0441\u044c"})]}),Object(P.jsxs)(V.a,{children:[Object(P.jsx)(y.a,{step:1,min:0,max:48,value:s,top:Object(P.jsxs)(g.a,{indicator:Object(P.jsx)(A.a,{size:"m",mode:"primary",children:s}),children:[Object(P.jsx)("span",{role:"img","aria-label":"Toilet paper",children:"\ud83e\uddfb"})," \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0443\u043b\u043e\u043d\u043e\u0432"]}),onChange:function(e){return q(e)}}),Object(P.jsx)(y.a,{step:1,min:1,max:8,value:O,top:Object(P.jsxs)(g.a,{indicator:Object(P.jsx)(A.a,{size:"m",mode:"primary",children:O}),children:[Object(P.jsx)("span",{role:"img","aria-label":"Poo",children:"\ud83d\udca9"})," \u041f\u043e\u0441\u0435\u0449\u0435\u043d\u0438\u0439 \u0442\u0443\u0430\u043b\u0435\u0442\u0430 \u0432 \u0434\u0435\u043d\u044c"]}),onChange:function(e){return Q(e)}}),Object(P.jsx)(y.a,{step:1,min:1,max:16,value:N,top:Object(P.jsxs)(g.a,{indicator:Object(P.jsx)(A.a,{size:"m",mode:"primary",children:N}),children:[Object(P.jsx)("span",{role:"img","aria-label":"People in household",children:"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66"})," \u041b\u044e\u0434\u0435\u0439 \u0434\u043e\u043c\u0430"]}),onChange:function(e){return R(e)}})]}),Object(P.jsx)(C.a,{vertical:"bottom",children:Object(P.jsx)(w.a,{className:"PooBtnContainer",children:Object(P.jsx)(S.a,{className:"PooBtn",size:"xl",onClick:L,children:Object(P.jsx)("img",{src:W,alt:"Toilet paper roll"})})})}),F]})},J=(n(218),function(e){var t=e.id,n=e.snackbarError,r=e.fetchedState;return Object(P.jsxs)(x.a,{id:t,children:[Object(P.jsx)(m.a,{children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435"}),r&&Object(P.jsx)(_,{fetchedState:r,snackbarError:n})]})}),T=(n(219),function(e){var t=e.id,n=e.go,a=e.route,c=e.fetchedUser,s=e.userHasSeenIntro;return Object(P.jsxs)(x.a,{id:t,centered:!0,children:[Object(P.jsx)(m.a,{children:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"}),c&&!s&&Object(P.jsxs)(r.Fragment,{children:[Object(P.jsx)(k.a,{children:Object(P.jsxs)(w.a,{className:"User",children:[c.photo_200?Object(P.jsx)(h.a,{src:c.photo_200}):null,">",Object(P.jsxs)("h3",{children:[c.first_name,", \u0438\u0433\u0440\u0430 \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u043d\u0430 \u0441\u0442\u0430\u0434\u0438\u0438 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0438! \u0412\u0441\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043c\u043e\u0436\u043d\u043e \u043d\u0430\u0439\u0442\u0438 \u0443 \u043d\u0430\u0441 \u0432 \u0433\u0440\u0443\u043f\u043f\u0435!"]})]})}),Object(P.jsx)(C.a,{vertical:"bottom",children:Object(P.jsx)(w.a,{children:Object(P.jsx)(S.a,{stretched:!0,size:"l",mode:"commerce",onClick:function(){return n(a)},children:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u0433\u0440\u0443\u043f\u043f\u0443"})})})]})]})}),U="home",B="intro",H="state",D="viewStatus",F=function(){var e=Object(r.useState)(B),t=Object(j.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),s=Object(j.a)(c,2),o=s[0],O=s[1],x=Object(r.useState)(null),m=Object(j.a)(x,2),v=m[0],y=m[1],g=Object(r.useState)(null),S=Object(j.a)(g,2),k=S[0],C=S[1],w=Object(r.useState)(Object(P.jsx)(f.a,{size:"large"})),V=Object(j.a)(w,2),A=V[0],N=V[1],z=Object(r.useState)(!1),W=Object(j.a)(z,2),I=W[0],K=W[1];Object(r.useEffect)((function(){function e(){return(e=Object(l.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.send("VKWebAppGetUserInfo");case 2:return t=e.sent,e.next=5,i.a.send("VKWebAppStorageGet",{keys:[H,D]});case 5:n=e.sent,Array.isArray(n.keys)?(r={},n.keys.forEach((function(e){var t=e.key,n=e.value;try{switch(r[t]=n?JSON.parse(n):{},t){case H:y(r[H]);break;case D:r[t]&&r[t].hasSeenIntro&&(a(B),K(!1))}}catch(c){C(Object(P.jsx)(d.a,{layout:"vertical",onClose:function(){return C(null)},before:Object(P.jsx)(h.a,{size:24,style:{backgroundColor:"var(--dynamic_red)"},children:Object(P.jsx)(p.a,{fill:"#fff",width:14,height:14})}),duration:900,children:"\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u0441 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 Storage"})),y({})}}))):y({}),O(t),N(null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}i.a.subscribe((function(e){var t=e.detail,n=t.type,r=t.data;if("VKWebAppUpdateConfig"===n){var a=document.createAttribute("scheme");a.value=r.scheme?r.scheme:"client_light",document.body.attributes.setNamedItem(a)}})),function(){e.apply(this,arguments)}()}),[]);var E=function(e){a(e)},_=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.a.send("VKWebAppStorageSet",{key:D,value:JSON.stringify({hasSeenIntro:!0})});case 3:E(t),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),C(Object(P.jsx)(d.a,{layout:"vertical",onClose:function(){return C(null)},before:Object(P.jsx)(h.a,{size:24,style:{backgroundColor:"var(--dynamic_red)"},children:Object(P.jsx)(p.a,{fill:"#fff",width:14,height:14})}),duration:900,children:"\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u0430 \u0441 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 Storage"}));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(P.jsxs)(b.a,{activePanel:n,popout:A,children:[Object(P.jsx)(J,{id:U,fetchedState:v,snackbarError:k}),Object(P.jsx)(T,{id:B,fetchedUser:o,go:_,route:U,userHasSeenIntro:I})]})};i.a.send("VKWebAppInit"),c.a.render(Object(P.jsx)(F,{}),document.getElementById("root"))}},[[220,1,2]]]);
//# sourceMappingURL=main.12e85d5f.chunk.js.map